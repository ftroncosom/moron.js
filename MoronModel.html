<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>moron.js Class: MoronModel</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.dark.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cyborg.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">moron.js</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="MoronEagerFetcher.html">MoronEagerFetcher</a>
						</li>
						
						<li>
							<a href="MoronHasManyRelation.html">MoronHasManyRelation</a>
						</li>
						
						<li>
							<a href="MoronHasOneRelation.html">MoronHasOneRelation</a>
						</li>
						
						<li>
							<a href="MoronManyToManyRelation.html">MoronManyToManyRelation</a>
						</li>
						
						<li>
							<a href="MoronModel.html">MoronModel</a>
						</li>
						
						<li>
							<a href="MoronModelBase.html">MoronModelBase</a>
						</li>
						
						<li>
							<a href="MoronQueryBuilder.html">MoronQueryBuilder</a>
						</li>
						
						<li>
							<a href="MoronRelation.html">MoronRelation</a>
						</li>
						
						<li>
							<a href="MoronRelationExpression.html">MoronRelationExpression</a>
						</li>
						
						<li>
							<a href="MoronRelationExpressionNode.html">MoronRelationExpressionNode</a>
						</li>
						
						<li>
							<a href="MoronRelationExpressionParser.html">MoronRelationExpressionParser</a>
						</li>
						
						<li>
							<a href="MoronValidationError.html">MoronValidationError</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#inherits">inherits</a>
						</li>
						
						<li>
							<a href="global.html#isSubclassOf">isSubclassOf</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
		<div class="span8">
			
				<div id="main">
					


	<!--<h1 class="page-title">Class: MoronModel</h1>-->
<section>

<header>
    <h2>
    MoronModel
    </h2>
    
</header>

<article>
    <div class="container-overview">
    

    
        
<dt>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Subclasses of this class represent database tables.</p>
<p>Subclass can be created like this:</p>
<pre class="prettyprint source lang-js"><code>function Person() {
  MoronModel.apply(this, arguments);
}

MoronModel.extend(Person);

Person.prototype.fullName = function () {
  return this.firstName + ' ' + this.lastName;
};

Person.tableName = 'Person';

Person.jsonSchema = {
  type: 'object',
  properties: {
    id: {type: 'integer'},
    firstName: {type: 'string'},
    lastName: {type: 'string'}
  }
};

Person.relationMappings = {
  pets: {
    relation: MoronModel.OneToManyRelation,
    modelClass: Animal,
    join: {
      from: 'Person.id',
      to: 'Animal.ownerId'
    }
  },
  mother: {
    relation: MoronModel.OneToOneRelation,
    modelClass: Person,
    join: {
      from: 'Person.motherId',
      to: 'Person.id'
    }
  }
};</code></pre>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

    
    </div>

    
        <h3 class="subsection-title">Extends</h3>

        <ul>
            <li><a href="MoronModelBase.html">MoronModelBase</a></li>
        </ul>
    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
        
            
              
<dt>
    
        <h4 class="name" id="_P_getRelation">
          <span class="modifiers-container"><span class="type-signature">&lt;static> </span></span>
          <span class="content">getRelation</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {<a href="MoronRelation.html">MoronRelation</a>}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type"><a href="MoronRelation.html">MoronRelation</a></span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="_P_getRelations">
          <span class="modifiers-container"><span class="type-signature">&lt;static> </span></span>
          <span class="content">getRelations</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {Object.&lt;String, <a href="MoronRelation.html">MoronRelation</a>>}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object.&lt;String, <a href="MoronRelation.html">MoronRelation</a>></span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
        
            
        
            
              
<dt>
    
        <h4 class="name" id="SafterValidate">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$afterValidate</span>
          <span class="signature-container"><span class="signature">(<span class="optional">json</span>, <span class="optional">options</span>)</span><span class="type-signature"></span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called after successful validation.</p>
<p>You can do further validation here and throw a MoronValidationError if something goes wrong.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The JSON object to validate.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#MoronModelOptions">MoronModelOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional options.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$afterValidate">MoronModelBase#$afterValidate</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SbeforeValidate">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$beforeValidate</span>
          <span class="signature-container"><span class="signature">(jsonSchema, json, <span class="optional">options</span>)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called before validation.</p>
<p>Here you can dynamically edit the jsonSchema if needed.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>jsonSchema</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>A deep clone of this class's jsonSchema.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The JSON object to be validated.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#MoronModelOptions">MoronModelOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional options.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$beforeValidate">MoronModelBase#$beforeValidate</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The (possibly) modified jsonSchema.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="Sclone">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$clone</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {<a href="MoronModelBase.html">MoronModelBase</a>}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns a deep copy of this model.</p>
<p>If this object has instances of MoronModelBase as properties (or arrays of them)
they are cloned using their <code>.$clone()</code> method.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$clone">MoronModelBase#$clone</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type"><a href="MoronModelBase.html">MoronModelBase</a></span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SformatDatabaseJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$formatDatabaseJson</span>
          <span class="signature-container"><span class="signature">(json)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called when a MoronModelBase is converted to database format.</p>
<p>Converts the JSON object from the internal format to the database format.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The JSON object in internal format.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$formatDatabaseJson">MoronModelBase#$formatDatabaseJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The JSON object in database format.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SformatJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$formatJson</span>
          <span class="signature-container"><span class="signature">(json)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called when a MoronModelBase is converted to JSON.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The JSON object in internal format</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$formatJson">MoronModelBase#$formatJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The JSON object in external format.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="Sid">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$id</span>
          <span class="signature-container"><span class="signature">(<span class="optional">id</span>)</span><span class="type-signature"> &rarr; {*}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns or sets the identifier of a model instance.</p>
<pre class="prettyprint source lang-js"><code>// Returns the id.
model.$id();
// Sets the id.
model.$id(100);</code></pre><p>The identifier property does not have to be accessed or set using this method.
If the identifier property is known it can be accessed or set just like any
other property:</p>
<pre class="prettyprint source lang-js"><code>console.log(model.id);
model.id = 100;</code></pre><p>This method is just a helper for the cases where the id property is not known.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">*</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SloadRelated">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$loadRelated</span>
          <span class="signature-container"><span class="signature">(relationExpression)</span><span class="type-signature"> &rarr; {Promise}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Loads related models using a <a href="MoronRelationExpression.html">MoronRelationExpression</a>.</p>
<p>Example:</p>
<pre class="prettyprint source"><code>jennifer.$loadRelated('[pets, children.[pets, father]]').then(function (jennifer) {
  console.log('Jennifer has', jennifer.pets.length, 'pets');
  console.log('Jennifer has', jennifer.children.length, 'children');
  console.log('Jennifer\'s first child has', jennifer.children[0].pets.length, 'pets');
  console.log('Jennifer had her first child with', jennifer.children[0].father.name);
});</code></pre>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>relationExpression</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type"><a href="MoronRelationExpression.html">MoronRelationExpression</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	
	<dt class="tag-see">See:</dt>
	<dd class="tag-see">
		<ul>
			<li><a href="MoronRelationExpression.html">MoronRelationExpression</a> for more examples on relation expressions.</li>
			</ul>
	</dd>
	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Promise</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SparseDatabaseJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$parseDatabaseJson</span>
          <span class="signature-container"><span class="signature">(json)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called when a MoronModelBase is created from a database JSON object.</p>
<p>Converts the JSON object from the database format to the internal format.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The JSON object in database format.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$parseDatabaseJson">MoronModelBase#$parseDatabaseJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The JSON object in internal format.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SparseJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$parseJson</span>
          <span class="signature-container"><span class="signature">(json, <span class="optional">options</span>)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This is called when a MoronModelBase is created from a JSON object.</p>
<p>Converts the JSON object to the internal format.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The JSON object in external format.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#MoronModelOptions">MoronModelOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional options.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$parseJson">MoronModelBase#$parseJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The JSON object in internal format.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="Squery">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$query</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {<a href="MoronQueryBuilder.html">MoronQueryBuilder</a>}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Creates a query builder for this model instance.</p>
<p>All queries built using this method only affect this instance. For example to
re-fetch the model from the database you can do this:</p>
<pre class="prettyprint source lang-js"><code>model.$query().then(function (model) {
  console.log(model);
});</code></pre><p>Insert a new model to database.</p>
<pre class="prettyprint source lang-js"><code>Person.fromJson({firstName: 'Jennifer'}).$query().insert().then(function (jennifer) {
  console.log(jennifer.id);
});</code></pre><p>Patch values of an existing model:</p>
<pre class="prettyprint source lang-js"><code>person.$query().patch({lastName: 'Cooper'}).then(function (person) {
  console.log(person.lastName); // --> 'Cooper'.
});</code></pre><p>Delete a model.</p>
<pre class="prettyprint source lang-js"><code>person.$query().delete().then(function () {
  console.log('person deleted');
});</code></pre>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type"><a href="MoronQueryBuilder.html">MoronQueryBuilder</a></span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SrelatedQuery">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$relatedQuery</span>
          <span class="signature-container"><span class="signature">(relationName)</span><span class="type-signature"> &rarr; {<a href="MoronQueryBuilder.html">MoronQueryBuilder</a>}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Use this to build a query that only affects the models related to this instance through a relation.</p>
<p>Fetch all models related to this instance through a relation. The fetched models are
also stored to the owner model's property named after the relation:</p>
<pre class="prettyprint source lang-js"><code>jennifer.$relatedQuery('pets').then(function (pets) {
  console.log('jennifer has', pets.length, 'pets');
  console.log(jennifer.pets === pets); // --> true
});</code></pre><p>The related query is just like any other query. All <em>knex</em> methods are available:</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .select('Animal.*', 'Person.name as ownerName')
  .where('species', '=', 'dog')
  .orWhere('breed', '=', 'cat')
  .innerJoin('Person', 'Person.id', 'Animal.ownerId')
  .orderBy('Animal.name')
  .then(function (dogsAndCats) {
    // All the dogs and cats have the owner's name &quot;Jennifer&quot; joined as the `ownerName` property.
    console.log(dogsAndCats);
  });</code></pre><p>This inserts a new model to the database and binds it to the owner model as defined
by the relation:</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .insert({species: 'dog', name: 'Fluffy'})
  .then(function (waldo) {
    console.log(waldo.id);
  });</code></pre><p>To add an existing model to a relation the <code>relate</code> method can be used. In this example
the dog <code>fluffy</code> already exists in the database but it isn't related to <code>jennifer</code> through
the <code>pets</code> relation. We can make the connection like this:</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .relate(fluffy)
  .then(function () {
    console.log('fluffy is now related to jennifer through pets relation');
  });</code></pre><p>The connection can be removed using the <code>unrelate</code> method. Again, this doesn't delete the
related model. Only the connection is removed. For example in the case of ManyToMany relation
the join table entries are deleted.</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .unrelate(fluffy.id)
  .then(function () {
    console.log('jennifer no longer has fluffy as a pet');
  });</code></pre><p>Related models can be deleted using the delete method. Delete method deletes the related
model <em>and</em> any connections to the owner. Naturally the delete query can be chained with
any <em>knex</em> methods.</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .delete()
  .where('species', 'cat')
  .then(function () {
    console.log('jennifer no longer has any cats');
  });</code></pre><p><code>update</code> and <code>patch</code> can be used to update related models. Only difference between the mentioned
methods is that <code>update</code> validates the input objects using the related model class's full schema
and the <code>patch</code> ignores the <code>required</code> property of the schema. Use <code>update</code> when you want to update
<em>all</em> properties of a model and <code>patch</code> when only a subset should be updated.</p>
<pre class="prettyprint source lang-js"><code>jennifer
  .$relatedQuery('pets')
  .update({species: 'dog', name: 'Fluffy the great', vaccinated: false})
  .where('id', fluffy.id)
  .then(function (updatedFluffy) {
    console.log('fluffy\'s new name is', updatedFluffy.name);
  });

// This will throw assuming that `name` or `species` is a required property for an Animal.
jennifer.$relatedQuery('pets').patch({vaccinated: true});

// This will _not_ throw.
jennifer
  .$relatedQuery('pets')
  .patch({vaccinated: true})
  .where('species', 'dog')
  .then(function () {
    console.log('jennifer just got all her dogs vaccinated');
  });</code></pre>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>relationName</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>Name of the relation.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type"><a href="MoronQueryBuilder.html">MoronQueryBuilder</a></span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SsetDatabaseJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$setDatabaseJson</span>
          <span class="signature-container"><span class="signature">(json)</span><span class="type-signature"></span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Sets the values from a JSON object in database format.</p>
<p>Calls <code>this.$parseDatabaseJson()</code>.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The JSON object in database format.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$setDatabaseJson">MoronModelBase#$setDatabaseJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="SsetJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$setJson</span>
          <span class="signature-container"><span class="signature">(json, <span class="optional">options</span>)</span><span class="type-signature"></span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Sets the values from a JSON object.</p>
<p>Validates the JSON before setting values. Calls <code>this.$parseJson()</code>.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The JSON object to set.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#MoronModelOptions">MoronModelOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional options.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$setJson">MoronModelBase#$setJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    <h5>Throws:</h5>
    
            

    <div class="param-desc">
    
        <p>MoronValidationError
   If validation fails.</p>
    
    </div>


        
    
    
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="StoDatabaseJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$toDatabaseJson</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Exports this model as a database JSON object.</p>
<p>Calls <code>$formatDatabaseJson()</code>.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$toDatabaseJson">MoronModelBase#$toDatabaseJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>This model as a JSON object in database format.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="StoJson">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$toJson</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Exports this model as a JSON object.</p>
<p>Calls <code>$formatJson()</code>.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$toJson">MoronModelBase#$toJson</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>This model as a JSON object.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="Svalidate">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">$validate</span>
          <span class="signature-container"><span class="signature">(<span class="optional">json</span>, <span class="optional">options</span>)</span><span class="type-signature"> &rarr; {Object}</span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Validates the given JSON object.</p>
<p>Calls <code>$beforeValidation</code> and <code>$afterValidation</code> methods. This method is called
automatically from <code>fromJson</code> and <code>$setJson</code> methods. This method can also be
called explicitly when needed.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		
		<th>Argument</th>
		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>json</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>If not given ==&gt; this.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#MoronModelOptions">MoronModelOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional options.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#$validate">MoronModelBase#$validate</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    <h5>Throws:</h5>
    
            

<dl>
    <dt>
        <div class="param-desc">
        <p>If validation fails.</p>
        </div>
    </dt>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="MoronValidationError.html">MoronValidationError</a></span>


            </dd>
        </dl>
    </dt>
</dl>


        
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The input json</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="param-type">Object</span>


	</dd>
</dl>


        
    
    
</dd>

            
        
            
              
<dt>
    
        <h4 class="name" id="toJSON">
          <span class="modifiers-container"><span class="type-signature"></span></span>
          <span class="content">toJSON</span>
          <span class="signature-container"><span class="signature">()</span><span class="type-signature"></span></span>
        </h4>
    
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Alias for <code>this.$toJson()</code>.</p>
<p>For JSON.stringify compatibility.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	
	<dt class="inherited-from">Inherited From:</dt>
	<dd class="inherited-from">
		<ul class="dummy">
			<li>
				<a href="MoronModelBase.html#toJSON">MoronModelBase#toJSON</a>
			</li>
		</ul>
	</dd>
	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

            
        </dl>
    

    

    
</article>

</section>




				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		moron.js Copyright © 2015-2015 Sami Koskimäki.
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.1</a>
		on Wed Jun 10th 2015 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<div class="span3">
				<div id="toc"></div>
			</div>
			
			<br clear="both">
		</div>

	</div>
	<!-- <script src="scripts/sunlight.js"></script> -->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );
				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( '.dropdown-toggle' ).dropdown();
			$( "pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( "pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );

      $( "#toc" ).toc( {
        anchorName  : function ( i, heading, prefix ) {
          return $( heading ).attr( "id" ) || ( prefix + i );
        },
        selectors   : "h1,h2,h3,h4",
        showAndHide : false,
        scrollTo    : "100px"
      } );

      $( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
      $( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>