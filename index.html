<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>moron.js Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.dark.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cyborg.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">moron.js</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="MoronManyToManyRelation.html">MoronManyToManyRelation</a>
						</li>
						
						<li>
							<a href="MoronModel.html">MoronModel</a>
						</li>
						
						<li>
							<a href="MoronModelBase.html">MoronModelBase</a>
						</li>
						
						<li>
							<a href="MoronOneToManyRelation.html">MoronOneToManyRelation</a>
						</li>
						
						<li>
							<a href="MoronOneToOneRelation.html">MoronOneToOneRelation</a>
						</li>
						
						<li>
							<a href="MoronQueryBuilder.html">MoronQueryBuilder</a>
						</li>
						
						<li>
							<a href="MoronRelation.html">MoronRelation</a>
						</li>
						
						<li>
							<a href="MoronRelationExpression.html">MoronRelationExpression</a>
						</li>
						
						<li>
							<a href="MoronValidationError.html">MoronValidationError</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#ensureArray">ensureArray</a>
						</li>
						
						<li>
							<a href="global.html#inherits">inherits</a>
						</li>
						
						<li>
							<a href="global.html#isSubclassOf">isSubclassOf</a>
						</li>
						
						<li>
							<a href="global.html#queryMethod">queryMethod</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
		<div class="span8">
			
				<div id="main">
					


	
	<span class="page-title">Index</span>
	
	












	
	





    <section class="readme-section">
        <article><h1>moron.js <a href="https://travis-ci.org/Vincit/moron.js"><img src="https://travis-ci.org/Vincit/moron.js.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/r/Vincit/moron.js"><img src="https://coveralls.io/repos/Vincit/moron.js/badge.svg" alt="Coverage Status"></a></h1><p>A Node.js ORM that doesn't get in your way.</p>
<p>Moron.js is an ORM built around the wonderful SQL query builder called <a href="http://knexjs.org">knex</a>. All databases
supported by knex are supported by moron.js. The list includes SQLite3, Postgres and MySQL.</p>
<p>What moron.js gives you:</p>
<ul>
<li>An easy declarative way of defining models and relations between them.</li>
<li>Simple and fun way to fetch, insert, update, patch and delete models using SQL.</li>
<li>Powerful mechanism for loading arbitrarily big trees of relations.</li>
<li>JSON schema validation.</li>
</ul>
<p>What moron.js doesn't give you:</p>
<ul>
<li>A custom query DSL. All queries are generated using the knex's SQL query builder.</li>
<li>Automatic database schema creation. Moron.js leaves this to you. knex has a <a href="http://knexjs.org/#Migrations">great tool</a> for this.</li>
</ul>
<h1>Installation</h1><pre class="prettyprint source lang-sh"><code>npm install moron</code></pre><h1>Getting started</h1><p>Best way to get started is to download the example project <a href="">here</a>. Unzip the project and <code>cd</code> to the folder. Then
write the commands:</p>
<pre class="prettyprint source lang-sh"><code>sh install.sh
node app.js</code></pre><p>The example project is a simple express server. The <code>example-requests</code> file contains a bunch of example curl commands
for you to start playing with the REST API.</p>
<pre class="prettyprint source lang-sh"><code>cat example-requests</code></pre><p>Also our <a href="http://vincit.github.io/moron.js">API documentation</a> contains a lot of examples.</p>
<h1>Examples</h1><p>Fetch all Person models from the database:</p>
<pre class="prettyprint source lang-js"><code>Person.query().then(function (persons) {
  console.log(persons[0] instanceof Person); // --> true
  console.log('there are', persons.length, 'in total');
}).catch(function (err) {
  console.log('oh noes');
});</code></pre><p>Query with a where clause:</p>
<pre class="prettyprint source lang-js"><code>Person
  .query()
  .where('age', '>', 40)
  .andWhere('age', '&lt;', 60)
  .andWhere('firstName', 'Jennifer')
  .orderBy('lastName')
  .then(function (middleAgedJennifers) {
    console.log('The last name of the first middle aged Jennifer is');
    console.log(middleAgedJennifers[0].lastName);
  });</code></pre><p>Insert a related model:</p>
<pre class="prettyprint source lang-js"><code>Person
  .query()
  .where('id', 100)
  .first()
  .then(function (person) {
    return person.$relatedQuery('pets').insert({name: 'Fluffy'});
  })
  .then(function (fluffy) {
    console.log(fully.id);
  })
  .catch(function (err) {
    console.log('something went wrong with finding the person OR inserting the pet');
    console.log(err.stack);
  });</code></pre><p>Fetch relations eagerly:</p>
<pre class="prettyprint source lang-js"><code>Person
  .query()
  .eager('[pets, children.pets]')
  .then(function (persons) {
    // Each person has the `.pets` property populated with Animal objects related
    // through `pets` relation. The `.children` property contains the Person's
    // children. Each children also has the `pets` relation eagerly fetched.
    console.log(persons[0].pets[0].name);
    console.log(persons[3].children[2].pets[8].name);
  });</code></pre><p>Transaction:</p>
<pre class="prettyprint source lang-js"><code>moron.transaction(Person, Animal, function (Person, Animal) {
  return Person
    .insert({firstName: 'Jennifer', lastName: 'Lawrence'})
    .then(function () {
      return Animal.insert({name: 'Scrappy'});
    });
}).then(function (fluffy) {
  console.log('Jennifer and Scrappy were successfully inserted');
}).catch(function (err) {
  console.log('Something went wrong. Neither Jennifer nor Scrappy were inserted');
});</code></pre><p>The <a href="#getting-started">example project</a> contains more examples.</p>
<h1>Example model</h1><p>Models are created by inheriting from the <code>MoronModel</code> base class. In moron.js the inheritance is done as transparently
as possible. There is no custom Class abstraction making you wonder what the hell is happening. Just plain old ugly
javascript inheritance :D.</p>
<pre class="prettyprint source lang-js"><code>var MoronModel = require('moron').MoronModel;

function Person() {
  MoronModel.apply(this, arguments);
}

module.exports = MoronModel.extend(Person);

// Table name is the only required property.
Person.tableName = 'Person';

// This is not the database schema! Nothing is generated based on this. This a schema
// for the JSON objects from which Persons are created.
Person.jsonSchema = {
  type: 'object',
  required: ['firstName', 'lastName'],

  properties: {
    id: {type: 'integer'},
    parentId: {type: ['integer', 'null']},
    firstName: {type: 'string', minLength: 1, maxLength: 255},
    firstName: {type: 'string', minLength: 1, maxLength: 255},
    age: {type: 'number'}
  }
};

// This object defines the relations to other models. Person has two relations `pets`
// and `children`.
Person.relationMappings = {
  pets: {
    relation: MoronModel.OneToManyRelation,
    // The related model. This can be either a MoronModel subclass constructor or an
    // absolute file path to a module that exports one.
    modelClass: __dirname + '/Animal',
    join: {
      from: 'Person.id',
      to: 'Animal.ownerId'
    }
  },

  children: {
    relation: MoronModel.OneToManyRelation,
    modelClass: Person,
    join: {
      from: 'Person.id',
      to: 'Person.parentId'
    }
  }
};</code></pre></article>
    </section>







				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		moron.js Copyright © 2015-2015 Sami Koskimäki.
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.1</a>
		on Fri Jun 12th 2015 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<div class="span3">
				<div id="toc"></div>
			</div>
			
			<br clear="both">
		</div>

	</div>
	<!-- <script src="scripts/sunlight.js"></script> -->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );
				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( '.dropdown-toggle' ).dropdown();
			$( "pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( "pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );

      $( "#toc" ).toc( {
        anchorName  : function ( i, heading, prefix ) {
          return $( heading ).attr( "id" ) || ( prefix + i );
        },
        selectors   : "h1,h2,h3,h4",
        showAndHide : false,
        scrollTo    : "100px"
      } );

      $( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
      $( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>